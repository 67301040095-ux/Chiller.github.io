<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>3D Chiller SCADA Demo</title>
<style>
body{margin:0;overflow:hidden;background:#d0d3d6;}
#panel{
 position:absolute;
 top:20px;left:20px;
 background:rgba(255,255,255,.9);
 padding:15px;border-radius:8px;
 font-family:Segoe UI;
}
button{padding:6px 12px;margin-top:5px}
</style>
</head>
<body>

<div id="panel">
<b>CHILLER PLANT</b><br>
Supply Temp: <span id="temp">45°F</span><br>
<button onclick="start()">START</button>
<button onclick="stop()">STOP</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.158/build/three.min.js"></script>

<script>
let scene = new THREE.Scene();
let camera = new THREE.PerspectiveCamera(45, window.innerWidth/window.innerHeight, 1, 5000);
let renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// Camera fixed isometric
camera.position.set(900,700,900);
camera.lookAt(0,0,0);

// Lighting
let light = new THREE.DirectionalLight(0xffffff,1);
light.position.set(500,1000,500);
scene.add(light);
scene.add(new THREE.AmbientLight(0x888888));

// Floor
let floorGeo = new THREE.PlaneGeometry(2000,2000);
let floorMat = new THREE.MeshPhongMaterial({color:0xaaaaaa});
let floor = new THREE.Mesh(floorGeo,floorMat);
floor.rotation.x = -Math.PI/2;
scene.add(floor);

// Cooling Tower
function createTower(x,z){
 let bodyGeo = new THREE.BoxGeometry(120,250,120);
 let bodyMat = new THREE.MeshPhongMaterial({color:0xcfd6dd});
 let body = new THREE.Mesh(bodyGeo,bodyMat);
 body.position.set(x,125,z);
 scene.add(body);
}
createTower(-500,-300);
createTower(-300,-300);

// Chiller
function createChiller(x,z){
 let geo = new THREE.CylinderGeometry(60,60,350,32);
 let mat = new THREE.MeshPhongMaterial({color:0xd9dee4});
 let chill = new THREE.Mesh(geo,mat);
 chill.rotation.z = Math.PI/2;
 chill.position.set(x,100,z);
 scene.add(chill);
}
createChiller(0,0);
createChiller(350,0);

// Pump
function createPump(x,z){
 let geo = new THREE.CylinderGeometry(40,40,80,32);
 let mat = new THREE.MeshPhongMaterial({color:0x2ecc71});
 let pump = new THREE.Mesh(geo,mat);
 pump.position.set(x,40,z);
 scene.add(pump);
 return pump;
}

let pumps=[];
pumps.push(createPump(-500,200));
pumps.push(createPump(-350,200));
pumps.push(createPump(-200,200));
pumps.push(createPump(100,350));
pumps.push(createPump(250,350));
pumps.push(createPump(400,350));

// Pipes
function pipe(x1,y1,z1,x2,y2,z2,color){
 let mat=new THREE.MeshPhongMaterial({color:color});
 let dir=new THREE.Vector3(x2-x1,y2-y1,z2-z1);
 let len=dir.length();
 let geo=new THREE.CylinderGeometry(15,15,len,16);
 let mesh=new THREE.Mesh(geo,mat);
 mesh.position.set((x1+x2)/2,(y1+y2)/2,(z1+z2)/2);
 mesh.lookAt(new THREE.Vector3(x2,y2,z2));
 mesh.rotateX(Math.PI/2);
 scene.add(mesh);
}
pipe(-450,80,-300,-450,80,0,0xd6a04b); // CW
pipe(0,80,0,800,80,0,0x00bfff); // CHWS

let running=false;
let temp=45;

function start(){running=true;}
function stop(){running=false;}

function animate(){
 requestAnimationFrame(animate);

 if(running){
   temp -= 0.02;
   pumps.forEach(p=>p.rotation.y+=0.1);
 }
 document.getElementById("temp").innerText=temp.toFixed(1)+"°F";

 renderer.render(scene,camera);
}
animate();
</script>

</body>
</html>
